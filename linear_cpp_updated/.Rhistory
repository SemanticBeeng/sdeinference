# summary(lm(y~x))
summary(lm(y~x))
par(mfrow = c(2,2))
# hist(thetamat[-(1:burnin),1], nclass = 30, main = "Posterior of theta1", xlab = "True value = red line", xlim = c(actualtheta[1] - 0.1, actualtheta[1] + 0.1))
# abline(v = mean(thetamat[-(1:burnin),1]))
# abline(v = actualtheta[1], col = "red")
hist(thetamat[-(1:burnin),2], nclass = 30, main = "Posterior of theta2", xlab = "True value = red line", xlim = c(actualtheta[2] - 0.1, actualtheta[2] + 0.1))
abline(v = mean(thetamat[-(1:burnin),2]))
abline(v = actualtheta[2], col = "red", col = "green")
hist(thetamat[-(1:burnin),3], nclass = 30, main = "Posterior of theta3", xlab = "True value = red line", xlim = c(actualtheta[3] - 0.1, actualtheta[3] + 0.1))
abline(v = mean(thetamat[-(1:burnin),3]), col = "green")
abline(v = actualtheta[3], col = "red")
# plot(thetamat[-(1:burnin),1], type = "l", xlab = "True value = red line", main = "HMC values of theta1", ylim = c(actualtheta[1] - 0.1, actualtheta[1] + 0.1))
# abline(h = actualtheta[1], col = "red")
plot(thetamat[-(1:burnin),2], type = "l", xlab = "True value = red line", main = "HMC values of theta2", ylim = c(actualtheta[2] - 0.1, actualtheta[2] + 0.1))
abline(h = actualtheta[2], col = "red")
plot(thetamat[-(1:burnin),3], type = "l", xlab = "True value = red line", main = "HMC values of theta3", ylim = c(actualtheta[3] - 0.1, actualtheta[3] + 0.1))
abline(h = actualtheta[3], col = "red")
# par(mfrow = c(2,3))
par(mfrow = c(2,2))
# hist(thetamat[-(1:burnin),1], nclass = 30, main = "Posterior of theta1", xlab = "True value = red line", xlim = c(actualtheta[1] - 0.1, actualtheta[1] + 0.1))
# abline(v = mean(thetamat[-(1:burnin),1]))
# abline(v = actualtheta[1], col = "red")
hist(thetamat[-(1:burnin),2], nclass = 30, main = "Posterior of theta2", xlab = "True value = red line", xlim = c(actualtheta[2] - 0.1, actualtheta[2] + 0.1))
abline(v = mean(thetamat[-(1:burnin),2]))
abline(v = actualtheta[2], col = "red", col = "green")
hist(thetamat[-(1:burnin),3], nclass = 30, main = "Posterior of theta3", xlab = "True value = red line", xlim = c(actualtheta[3] - 0.1, actualtheta[3] + 0.1))
abline(v = mean(thetamat[-(1:burnin),3]), col = "green")
abline(v = actualtheta[3], col = "red")
# plot(thetamat[-(1:burnin),1], type = "l", xlab = "True value = red line", main = "HMC values of theta1", ylim = c(actualtheta[1] - 0.1, actualtheta[1] + 0.1))
# abline(h = actualtheta[1], col = "red")
plot(thetamat[-(1:burnin),2], type = "l", xlab = "True value = red line", main = "HMC values of theta2", ylim = c(actualtheta[2] - 0.1, actualtheta[2] + 0.1))
abline(h = actualtheta[2], col = "red")
plot(thetamat[-(1:burnin),3], type = "l", xlab = "True value = red line", main = "HMC values of theta3", ylim = c(actualtheta[3] - 0.1, actualtheta[3] + 0.1))
abline(h = actualtheta[3], col = "red")
# for comparison:
# summary(lm(y~x))
# par(mfrow = c(2,3))
par(mfrow = c(2,2))
# hist(thetamat[-(1:burnin),1], nclass = 30, main = "Posterior of theta1", xlab = "True value = red line", xlim = c(actualtheta[1] - 0.1, actualtheta[1] + 0.1))
# abline(v = mean(thetamat[-(1:burnin),1]))
# abline(v = actualtheta[1], col = "red")
hist(thetamat[-(1:burnin),2], nclass = 30, main = "Posterior of theta2", xlab = "True value = red line", xlim = c(actualtheta[2] - 0.1, actualtheta[2] + 0.1))
abline(v = mean(thetamat[-(1:burnin),2]), col = "green")
abline(v = actualtheta[2], col = "red")
hist(thetamat[-(1:burnin),3], nclass = 30, main = "Posterior of theta3", xlab = "True value = red line", xlim = c(actualtheta[3] - 0.1, actualtheta[3] + 0.1))
abline(v = mean(thetamat[-(1:burnin),3]), col = "green")
abline(v = actualtheta[3], col = "red")
# plot(thetamat[-(1:burnin),1], type = "l", xlab = "True value = red line", main = "HMC values of theta1", ylim = c(actualtheta[1] - 0.1, actualtheta[1] + 0.1))
# abline(h = actualtheta[1], col = "red")
plot(thetamat[-(1:burnin),2], type = "l", xlab = "True value = red line", main = "HMC values of theta2", ylim = c(actualtheta[2] - 0.1, actualtheta[2] + 0.1))
abline(h = actualtheta[2], col = "red")
plot(thetamat[-(1:burnin),3], type = "l", xlab = "True value = red line", main = "HMC values of theta3", ylim = c(actualtheta[3] - 0.1, actualtheta[3] + 0.1))
abline(h = actualtheta[3], col = "red")
# for comparison:
# par(mfrow = c(2,3))
par(mfrow = c(2,2))
# hist(thetamat[-(1:burnin),1], nclass = 30, main = "Posterior of theta1", xlab = "True value = red line", xlim = c(actualtheta[1] - 0.1, actualtheta[1] + 0.1))
# abline(v = mean(thetamat[-(1:burnin),1]))
# abline(v = actualtheta[1], col = "red")
hist(thetamat[-(1:burnin),2], nclass = 30, main = "Posterior of theta2", xlab = "True value = red line", xlim = c(actualtheta[2] - 0.1, actualtheta[2] + 0.1))
abline(v = mean(thetamat[-(1:burnin),2]), col = "green")
abline(v = actualtheta[2], col = "red")
hist(thetamat[-(1:burnin),3], nclass = 30, main = "Posterior of theta3", xlab = "True value = red line", xlim = c(actualtheta[3] - 0.1, actualtheta[3] + 0.1))
abline(v = mean(thetamat[-(1:burnin),3]), col = "green")
abline(v = actualtheta[3], col = "red")
# plot(thetamat[-(1:burnin),1], type = "l", xlab = "True value = red line", main = "HMC values of theta1", ylim = c(actualtheta[1] - 0.1, actualtheta[1] + 0.1))
# abline(h = actualtheta[1], col = "red")
plot(thetamat[-(1:burnin),2], type = "l", xlab = "True value = red line", ylab = "theta2 values", main = "HMC values of theta2", ylim = c(actualtheta[2] - 0.1, actualtheta[2] + 0.1))
abline(h = actualtheta[2], col = "red")
plot(thetamat[-(1:burnin),3], type = "l", xlab = "True value = red line", ylab = "theta3 values", main = "HMC values of theta3", ylim = c(actualtheta[3] - 0.1, actualtheta[3] + 0.1))
abline(h = actualtheta[3], col = "red")
sum(artrack)
artrack = myout[[12]]
sum(artrack)
artrack = myout[[11]]
sum(artrack)
length(artrack)
artrack = artrack[101:600]
length(artrack)
sum(artrack)
385/500
rmserror = myout[[12]]
plot(rmserror)
lines(rmserror)
plot(rmserror)
lines(rmserror)
library(Hmisc)
minor.tick(nx=n, ny=n, tick.ratio=n)
install.packages('Hmisc')
plot(rmserror, type = "l")
plot(rmserror, type = "o")
plot(rmserror, type = lo")
plot(rmserror, type = "l")
rmserror = rmserror[101:600]
plot(rmserror, type = "l")
abline(v = mean(rmserror), col = "red")
abline(h = mean(rmserror), col = "red")
length(rmserror)
plot(rmserror, type = "l")
abline(h = mean(rmserror), col = "red")
library('coda')
chain = mcmc(thetamat)
startvalue = c(0.8, 0.5, 0.5)
chain = run_metropolis_MCMC(startvalue, 500)
summary(chain)
plot(chain)
chain = mcmc(thetamat[:,2:3])
summary(chain)
plot(chain)
plot(chain)
library(IDPmisc)
? acf
acf(thetamat[:,2])
theta2 = thetamat[:,2]
length(thetamat)
theta2 = thetamat[101:600,2]
acf(theta2)
plot(chain)
rm(list=ls(all=TRUE))
library('coda')
gridh = myout[[1]]
gridk=myout[[2]]
gridM = myout[[3]]
actualtheta = myout[[4]]
burnin = myout[[5]]
totsteps = myout[[6]]
hmc_epsilon = myout[[7]]
hmc_mu = myout[[8]]
hmc_mass = myout[[9]]
thetamat = myout[[10]]
artrack = myout[[11]]
rmserror = myout[[12]]
looptime = myout[[13]]
thetamatnew = thetamat[101:600, 2:3]
chain = mcmc(thetamatnew)
summary(chain)
plot(chain)
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_9.RData")
acceptance = 1 - mean(duplicated(thetamat[-(1:burnin),]))
########## First plotting technique ##########
par(mfrow = c(2,3))
# par(mfrow = c(2,2))
hist(thetamat[-(1:burnin),1], nclass = 30, main = "Posterior of theta1", xlab = "True value = red line", xlim = c(actualtheta[1] - 0.1, actualtheta[1] + 0.1))
abline(v = mean(thetamat[-(1:burnin),1]), col = "green")
abline(v = actualtheta[1], col = "red")
hist(thetamat[-(1:burnin),2], nclass = 30, main = "Posterior of theta2", xlab = "True value = red line", xlim = c(actualtheta[2] - 0.1, actualtheta[2] + 0.1))
abline(v = mean(thetamat[-(1:burnin),2]), col = "green")
abline(v = actualtheta[2], col = "red")
hist(thetamat[-(1:burnin),3], nclass = 30, main = "Posterior of theta3", xlab = "True value = red line", xlim = c(actualtheta[3] - 0.1, actualtheta[3] + 0.1))
abline(v = mean(thetamat[-(1:burnin),3]), col = "green")
abline(v = actualtheta[3], col = "red")
plot(thetamat[-(1:burnin),1], type = "l", xlab = "True value = red line", ylab = "theta2 values", main = "HMC values of theta1", ylim = c(actualtheta[1] - 0.1, actualtheta[1] + 0.1))
abline(h = actualtheta[1], col = "red")
plot(thetamat[-(1:burnin),2], type = "l", xlab = "True value = red line", ylab = "theta2 values", main = "HMC values of theta2", ylim = c(actualtheta[2] - 0.1, actualtheta[2] + 0.1))
abline(h = actualtheta[2], col = "red")
plot(thetamat[-(1:burnin),3], type = "l", xlab = "True value = red line", ylab = "theta3 values", main = "HMC values of theta3", ylim = c(actualtheta[3] - 0.1, actualtheta[3] + 0.1))
abline(h = actualtheta[3], col = "red")
par(mfrow = c(2,2))
# hist(thetamat[-(1:burnin),1], nclass = 30, main = "Posterior of theta1", xlab = "True value = red line", xlim = c(actualtheta[1] - 0.1, actualtheta[1] + 0.1))
# abline(v = mean(thetamat[-(1:burnin),1]), col = "green")
# abline(v = actualtheta[1], col = "red")
hist(thetamat[-(1:burnin),2], nclass = 30, main = "Posterior of theta2", xlab = "True value = red line", xlim = c(actualtheta[2] - 0.1, actualtheta[2] + 0.1))
abline(v = mean(thetamat[-(1:burnin),2]), col = "green")
abline(v = actualtheta[2], col = "red")
hist(thetamat[-(1:burnin),3], nclass = 30, main = "Posterior of theta3", xlab = "True value = red line", xlim = c(actualtheta[3] - 0.1, actualtheta[3] + 0.1))
abline(v = mean(thetamat[-(1:burnin),3]), col = "green")
abline(v = actualtheta[3], col = "red")
# plot(thetamat[-(1:burnin),1], type = "l", xlab = "True value = red line", ylab = "theta2 values", main = "HMC values of theta1", ylim = c(actualtheta[1] - 0.1, actualtheta[1] + 0.1))
# abline(h = actualtheta[1], col = "red")
plot(thetamat[-(1:burnin),2], type = "l", xlab = "True value = red line", ylab = "theta2 values", main = "HMC values of theta2", ylim = c(actualtheta[2] - 0.1, actualtheta[2] + 0.1))
abline(h = actualtheta[2], col = "red")
plot(thetamat[-(1:burnin),3], type = "l", xlab = "True value = red line", ylab = "theta3 values", main = "HMC values of theta3", ylim = c(actualtheta[3] - 0.1, actualtheta[3] + 0.1))
abline(h = actualtheta[3], col = "red")
library('coda')
chain = mcmc(thetamat)
summary(chain)
plot(chain)
thetamatnew = thetamat[101:600, 2:3]
summary(thetamatnew)
chain = mcmc(thetamatnew)
summary(chain)
plot(chain)
rmserror = rmserror[101:600]
plot(rmserror)
plot(rmserror,type = 'l')
plot(rmserror,type = 'l')
abline(v = mean(rmserror))
plot(rmserror,type = 'l')
abline(h = mean(rmserror), col = "red")
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_7.RData")
artrack = myout[[12]]
rm(list = ls(all=TRUE))
artrack = myout[[11]]
artrack=artrack[101:600]
sum(artrack)/length(artrack)
length(artrack)
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_8.RData")
artrack = myout[[11]]
artrack=artrack[101:600]
sum(artrack)/length(artrack)
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_9.RData")
par(mfrow = c(2,2))
# hist(thetamat[-(1:burnin),1], nclass = 30, main = "Posterior of theta1", xlab = "True value = red line", xlim = c(actualtheta[1] - 0.1, actualtheta[1] + 0.1))
# abline(v = mean(thetamat[-(1:burnin),1]), col = "green")
# abline(v = actualtheta[1], col = "red")
hist(thetamat[-(1:burnin),2], nclass = 30, main = "Posterior of theta2", xlab = "True value = red line", xlim = c(actualtheta[2] - 0.1, actualtheta[2] + 0.1))
attach(myout)
rm(list=ls(all=TRUE))
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_9.RData")
par(mfrow = c(2,2))
# hist(thetamat[-(1:burnin),1], nclass = 30, main = "Posterior of theta1", xlab = "True value = red line", xlim = c(actualtheta[1] - 0.1, actualtheta[1] + 0.1))
# abline(v = mean(thetamat[-(1:burnin),1]), col = "green")
# abline(v = actualtheta[1], col = "red")
hist(thetamat[-(1:burnin),2], nclass = 30, main = "Posterior of theta2", xlab = "True value = red line", xlim = c(actualtheta[2] - 0.1, actualtheta[2] + 0.1))
abline(v = mean(thetamat[-(1:burnin),2]), col = "green")
abline(v = actualtheta[2], col = "red")
lines(density(thetamat[-(1:burnin),2]), col = "blue")
plot(density(thetamat[-(1:burnin),2]), col = "blue")
par(mfrow = c(2,2))
# hist(thetamat[-(1:burnin),1], nclass = 30, main = "Posterior of theta1", xlab = "True value = red line", xlim = c(actualtheta[1] - 0.1, actualtheta[1] + 0.1))
# abline(v = mean(thetamat[-(1:burnin),1]), col = "green")
# abline(v = actualtheta[1], col = "red")
# lines(density(thetamat[-(1:burnin),2]), col = "blue")
hist(thetamat[-(1:burnin),2], nclass = 30, main = "Posterior of theta2", xlab = "True value = red line", xlim = c(actualtheta[2] - 0.1, actualtheta[2] + 0.1))
abline(v = mean(thetamat[-(1:burnin),2]), col = "green")
abline(v = actualtheta[2], col = "red")
lines(density(thetamat[-(1:burnin),2]), col = "blue")
hist(thetamat[-(1:burnin),3], nclass = 30, main = "Posterior of theta3", xlab = "True value = red line", xlim = c(actualtheta[3] - 0.1, actualtheta[3] + 0.1))
abline(v = mean(thetamat[-(1:burnin),3]), col = "green")
abline(v = actualtheta[3], col = "red")
lines(density(thetamat[-(1:burnin),3]), col = "blue")
# plot(thetamat[-(1:burnin),1], type = "l", xlab = "True value = red line", ylab = "theta2 values", main = "HMC values of theta1", ylim = c(actualtheta[1] - 0.1, actualtheta[1] + 0.1))
# abline(h = actualtheta[1], col = "red")
plot(thetamat[-(1:burnin),2], type = "l", xlab = "True value = red line", ylab = "theta2 values", main = "HMC values of theta2", ylim = c(actualtheta[2] - 0.1, actualtheta[2] + 0.1))
abline(h = actualtheta[2], col = "red")
plot(thetamat[-(1:burnin),3], type = "l", xlab = "True value = red line", ylab = "theta3 values", main = "HMC values of theta3", ylim = c(actualtheta[3] - 0.1, actualtheta[3] + 0.1))
abline(h = actualtheta[3], col = "red")
par(mfrow = c(2,2))
# hist(thetamat[-(1:burnin),1], nclass = 30, main = "Posterior of theta1", xlab = "True value = red line", xlim = c(actualtheta[1] - 0.05, actualtheta[1] + 0.05))
# abline(v = mean(thetamat[-(1:burnin),1]), col = "green")
# abline(v = actualtheta[1], col = "red")
# lines(density(thetamat[-(1:burnin),2]), col = "blue")
hist(thetamat[-(1:burnin),2], nclass = 30, main = "Posterior of theta2", xlab = "True value = red line", xlim = c(actualtheta[2] - 0.05, actualtheta[2] + 0.05))
abline(v = mean(thetamat[-(1:burnin),2]), col = "green")
abline(v = actualtheta[2], col = "red")
lines(density(thetamat[-(1:burnin),2]), col = "blue")
hist(thetamat[-(1:burnin),3], nclass = 30, main = "Posterior of theta3", xlab = "True value = red line", xlim = c(actualtheta[3] - 0.05, actualtheta[3] + 0.05))
abline(v = mean(thetamat[-(1:burnin),3]), col = "green")
abline(v = actualtheta[3], col = "red")
lines(density(thetamat[-(1:burnin),3]), col = "blue")
# plot(thetamat[-(1:burnin),1], type = "l", xlab = "True value = red line", ylab = "theta2 values", main = "HMC values of theta1", ylim = c(actualtheta[1] - 0.05, actualtheta[1] + 0.05))
# abline(h = actualtheta[1], col = "red")
plot(thetamat[-(1:burnin),2], type = "l", xlab = "True value = red line", ylab = "theta2 values", main = "HMC values of theta2", ylim = c(actualtheta[2] - 0.05, actualtheta[2] + 0.05))
abline(h = actualtheta[2], col = "red")
plot(thetamat[-(1:burnin),3], type = "l", xlab = "True value = red line", ylab = "theta3 values", main = "HMC values of theta3", ylim = c(actualtheta[3] - 0.05, actualtheta[3] + 0.05))
abline(h = actualtheta[3], col = "red")
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_8.RData")
par(mfrow = c(2,2))
# hist(thetamat[-(1:burnin),1], nclass = 30, main = "Posterior of theta1", xlab = "True value = red line", xlim = c(actualtheta[1] - 0.05, actualtheta[1] + 0.05))
# abline(v = mean(thetamat[-(1:burnin),1]), col = "green")
# abline(v = actualtheta[1], col = "red")
# lines(density(thetamat[-(1:burnin),2]), col = "blue")
hist(thetamat[-(1:burnin),2], nclass = 30, main = "Posterior of theta2", xlab = "True value = red line", xlim = c(actualtheta[2] - 0.05, actualtheta[2] + 0.05))
abline(v = mean(thetamat[-(1:burnin),2]), col = "green")
abline(v = actualtheta[2], col = "red")
lines(density(thetamat[-(1:burnin),2]), col = "blue")
hist(thetamat[-(1:burnin),3], nclass = 30, main = "Posterior of theta3", xlab = "True value = red line", xlim = c(actualtheta[3] - 0.05, actualtheta[3] + 0.05))
abline(v = mean(thetamat[-(1:burnin),3]), col = "green")
abline(v = actualtheta[3], col = "red")
lines(density(thetamat[-(1:burnin),3]), col = "blue")
# plot(thetamat[-(1:burnin),1], type = "l", xlab = "True value = red line", ylab = "theta2 values", main = "HMC values of theta1", ylim = c(actualtheta[1] - 0.05, actualtheta[1] + 0.05))
# abline(h = actualtheta[1], col = "red")
plot(thetamat[-(1:burnin),2], type = "l", xlab = "True value = red line", ylab = "theta2 values", main = "HMC values of theta2", ylim = c(actualtheta[2] - 0.05, actualtheta[2] + 0.05))
abline(h = actualtheta[2], col = "red")
plot(thetamat[-(1:burnin),3], type = "l", xlab = "True value = red line", ylab = "theta3 values", main = "HMC values of theta3", ylim = c(actualtheta[3] - 0.05, actualtheta[3] + 0.05))
abline(h = actualtheta[3], col = "red")
# for comparison:
par(mfrow = c(2,2))
# hist(thetamat[-(1:burnin),1], nclass = 30, main = "Posterior of theta1", xlab = "True value = red line", xlim = c(actualtheta[1] - 0.05, actualtheta[1] + 0.05))
# abline(v = mean(thetamat[-(1:burnin),1]), col = "green")
# abline(v = actualtheta[1], col = "red")
# lines(density(thetamat[-(1:burnin),2]), col = "blue")
hist(thetamat[-(1:burnin),2], nclass = 30, main = "Posterior of theta2", xlab = "True value = red line", xlim = c(actualtheta[2] - 0.05, actualtheta[2] + 0.05))
abline(v = mean(thetamat[-(1:burnin),2]), col = "green")
abline(v = actualtheta[2], col = "red")
lines(density(thetamat[-(1:burnin),2]), col = "blue")
hist(thetamat[-(1:burnin),3], nclass = 30, main = "Posterior of theta3", xlab = "True value = red line", xlim = c(actualtheta[3] - 0.05, actualtheta[3] + 0.05))
abline(v = mean(thetamat[-(1:burnin),3]), col = "green")
abline(v = actualtheta[3], col = "red")
lines(density(thetamat[-(1:burnin),3]), col = "blue")
# plot(thetamat[-(1:burnin),1], type = "l", xlab = "True value = red line", ylab = "theta2 values", main = "HMC values of theta1", ylim = c(actualtheta[1] - 0.05, actualtheta[1] + 0.05))
# abline(h = actualtheta[1], col = "red")
plot(thetamat[-(1:burnin),2], type = "l", xlab = "True value = red line", ylab = "theta2 values", main = "HMC values of theta2", ylim = c(actualtheta[2] - 0.05, actualtheta[2] + 0.05))
abline(h = actualtheta[2], col = "red")
plot(thetamat[-(1:burnin),3], type = "l", xlab = "True value = red line", ylab = "theta3 values", main = "HMC values of theta3", ylim = c(actualtheta[3] - 0.05, actualtheta[3] + 0.05))
abline(h = actualtheta[3], col = "red")
# for comparison:
a = c(1,2,3)
a^2
par(mfrow = c(2,2))
# hist(thetamat[-(1:burnin),1], nclass = 30, main = "Posterior of theta1", xlab = "True value = red line", xlim = c(actualtheta[1] - 0.05, actualtheta[1] + 0.05))
# abline(v = mean(thetamat[-(1:burnin),1]), col = "green")
# abline(v = actualtheta[1], col = "red")
# lines(density(thetamat[-(1:burnin),2]), col = "blue")
hist(thetamat[-(1:burnin),2], nclass = 30, main = "Posterior of theta2", xlab = "True value = red line", xlim = c(actualtheta[2] - 0.05, actualtheta[2] + 0.05))
abline(v = mean(thetamat[-(1:burnin),2]), col = "green")
abline(v = actualtheta[2], col = "red")
lines(density(thetamat[-(1:burnin),2]), col = "blue")
thetamat3new = (thetamat[-(1:burnin), 3])^2
newtheta3 = (actualtheta[3])^2
hist(thetamat3new, nclass = 30, main = "Posterior of theta3", xlab = "True value = red line", xlim = c(newtheta3 - 0.05, newtheta3 + 0.05))
abline(v = mean(thetamat3new), col = "green")
abline(v = actualtheta[3], col = "red")
lines(density(thetamat3new), col = "blue")
# hist(thetamat[-(1:burnin),3], nclass = 30, main = "Posterior of theta3", xlab = "True value = red line", xlim = c(actualtheta[3] - 0.05, actualtheta[3] + 0.05))
# abline(v = mean(thetamat[-(1:burnin),3]), col = "green")
# abline(v = actualtheta[3], col = "red")
# lines(density(thetamat[-(1:burnin),3]), col = "blue")
# plot(thetamat[-(1:burnin),1], type = "l", xlab = "True value = red line", ylab = "theta2 values", main = "HMC values of theta1", ylim = c(actualtheta[1] - 0.05, actualtheta[1] + 0.05))
# abline(h = actualtheta[1], col = "red")
plot(thetamat[-(1:burnin),2], type = "l", xlab = "True value = red line", ylab = "theta2 values", main = "HMC values of theta2", ylim = c(actualtheta[2] - 0.05, actualtheta[2] + 0.05))
abline(h = actualtheta[2], col = "red")
plot(thetamat3new], type = "l", xlab = "True value = red line", ylab = "theta3 values", main = "HMC values of theta3", ylim = c(newtheta3 - 0.05, newtheta3 + 0.05))
abline(h = newtheta3, col = "red")
par(mfrow = c(2,2))
# hist(thetamat[-(1:burnin),1], nclass = 30, main = "Posterior of theta1", xlab = "True value = red line", xlim = c(actualtheta[1] - 0.05, actualtheta[1] + 0.05))
# abline(v = mean(thetamat[-(1:burnin),1]), col = "green")
# abline(v = actualtheta[1], col = "red")
# lines(density(thetamat[-(1:burnin),2]), col = "blue")
hist(thetamat[-(1:burnin),2], nclass = 30, main = "Posterior of theta2", xlab = "True value = red line", xlim = c(actualtheta[2] - 0.05, actualtheta[2] + 0.05))
abline(v = mean(thetamat[-(1:burnin),2]), col = "green")
abline(v = actualtheta[2], col = "red")
lines(density(thetamat[-(1:burnin),2]), col = "blue")
thetamat3new = (thetamat[-(1:burnin), 3])^2
newtheta3 = (actualtheta[3])^2
hist(thetamat3new, nclass = 30, main = "Posterior of theta3", xlab = "True value = red line", xlim = c(newtheta3 - 0.05, newtheta3 + 0.05))
abline(v = mean(thetamat3new), col = "green")
abline(v = actualtheta[3], col = "red")
lines(density(thetamat3new), col = "blue")
# hist(thetamat[-(1:burnin),3], nclass = 30, main = "Posterior of theta3", xlab = "True value = red line", xlim = c(actualtheta[3] - 0.05, actualtheta[3] + 0.05))
# abline(v = mean(thetamat[-(1:burnin),3]), col = "green")
# abline(v = actualtheta[3], col = "red")
# lines(density(thetamat[-(1:burnin),3]), col = "blue")
# plot(thetamat[-(1:burnin),1], type = "l", xlab = "True value = red line", ylab = "theta2 values", main = "HMC values of theta1", ylim = c(actualtheta[1] - 0.05, actualtheta[1] + 0.05))
# abline(h = actualtheta[1], col = "red")
plot(thetamat[-(1:burnin),2], type = "l", xlab = "True value = red line", ylab = "theta2 values", main = "HMC values of theta2", ylim = c(actualtheta[2] - 0.05, actualtheta[2] + 0.05))
abline(h = actualtheta[2], col = "red")
plot(thetamat3new, type = "l", xlab = "True value = red line", ylab = "theta3 values", main = "HMC values of theta3", ylim = c(newtheta3 - 0.05, newtheta3 + 0.05))
abline(h = newtheta3, col = "red")
par(mfrow = c(2,2))
# hist(thetamat[-(1:burnin),1], nclass = 30, main = "Posterior of theta1", xlab = "True value = red line", xlim = c(actualtheta[1] - 0.05, actualtheta[1] + 0.05))
# abline(v = mean(thetamat[-(1:burnin),1]), col = "green")
# abline(v = actualtheta[1], col = "red")
# lines(density(thetamat[-(1:burnin),2]), col = "blue")
hist(thetamat[-(1:burnin),2], nclass = 30, main = "Posterior of theta2", xlab = "True value = red line", xlim = c(actualtheta[2] - 0.05, actualtheta[2] + 0.05))
abline(v = mean(thetamat[-(1:burnin),2]), col = "green")
abline(v = actualtheta[2], col = "red")
lines(density(thetamat[-(1:burnin),2]), col = "blue")
thetamat3new = (thetamat[-(1:burnin), 3])^2
newtheta3 = (actualtheta[3])^2
hist(thetamat3new, nclass = 30, main = "Posterior of theta3", xlab = "True value = red line", xlim = c(newtheta3 - 0.05, newtheta3 + 0.05))
abline(v = mean(thetamat3new), col = "green")
abline(v = newtheta3, col = "red")
lines(density(thetamat3new), col = "blue")
# hist(thetamat[-(1:burnin),3], nclass = 30, main = "Posterior of theta3", xlab = "True value = red line", xlim = c(actualtheta[3] - 0.05, actualtheta[3] + 0.05))
# abline(v = mean(thetamat[-(1:burnin),3]), col = "green")
# abline(v = actualtheta[3], col = "red")
# lines(density(thetamat[-(1:burnin),3]), col = "blue")
# plot(thetamat[-(1:burnin),1], type = "l", xlab = "True value = red line", ylab = "theta2 values", main = "HMC values of theta1", ylim = c(actualtheta[1] - 0.05, actualtheta[1] + 0.05))
# abline(h = actualtheta[1], col = "red")
plot(thetamat[-(1:burnin),2], type = "l", xlab = "True value = red line", ylab = "theta2 values", main = "HMC values of theta2", ylim = c(actualtheta[2] - 0.05, actualtheta[2] + 0.05))
abline(h = actualtheta[2], col = "red")
plot(thetamat3new, type = "l", xlab = "True value = red line", ylab = "theta3 values", main = "HMC values of theta3", ylim = c(newtheta3 - 0.05, newtheta3 + 0.05))
abline(h = newtheta3, col = "red")
hmcdatanum = 8
source('plotting.R')
source('plotting.R')
source('plotting.R')
source('plotting.R')
source('plotting.R')
source('plotting.R')
hmcdatanum = 9
source('plotting.R')
length(thetamat[-(1:burnin),2])
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_9.RData")
hmcdatanum = 9
source('plotting.R')
rm(list=ls(all=TRUE))
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_9.RData")
hmcdatanum = 9
source('plotting.R')
rm(list=ls(all=TRUE))
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_9.RData")
hmcdatanum = 9
source('plotting.R')
rm(list=ls(all=TRUE))
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_8.RData")
hmcdatanum = 8
source('plotting.R')
source('plotting.R')
source('plotting.R')
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_9.RData")
hmcdatanum = 9
source('plotting.R')
rm(list=ls(all=TRUE))
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_9.RData")
hmcdatanum = 9
source('plotting.R')
source('plotting.R')
? expression
library('base')
source('plotting.R')
source('plotting.R')
library(latex2exp)
rm(list=ls(all=TRUE))
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_8.RData")
install.packages('latex2exp')
source('plotting.R')
source('plotting.R')
library('latex2exp')
source('plotting.R')
source('plotting.R')
source('plotting.R')
source('plotting.R')
? latex2exp-deprecated
? TeX
source('plotting.R')
source('plotting.R')
source('plotting.R')
source('plotting.R')
source('plotting.R')
source('plotting.R')
source('plotting.R')
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_9.RData")
source('plotting.R')
source('plotting.R')
mean(rmserror)
source('plotting.R')
mean(rmserror)
source('plotting.R')
mean(rmserror)
source('plotting.R')
mean(rmserror)
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_8.RData")
rm(list=ls(all=TRUE))
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_8.RData")
gridh = myout[[1]]
gridk=myout[[2]]
gridM=myout[[3]]
actualtheta = myout[[4]]
burnin=myout[[5]]
totsteps = myout[[6]]
hmc_epsilon = myout[[7]]
hmc_mu = myout[[8]]
hmc_mass = myout[[9]]
thetamat = myout[[10]]
artrack = myout[[11]]
rmserror = myout[[12]]
looptime = myout[[13]]
hmc_steps = 10
myout = list("gridh" = gridh, "gridk" = gridk, "gridM" = gridM, "actualtheta" = actualtheta, "burnin" = burnin, "totsteps" = totsteps, "hmc_epsilon" = hmc_epsilon, "hmc_mu" = hmc_mu, "hmc_mass" = hmc_mass, "hmc_steps" = hmc_steps, "thetamat" = thetamat, "artrack" = artrack, "rmserror" = rmserror, "looptime" = looptime)
hmcdatanum = 8
fname = paste('HMCsamples_', hmcdatanum, '.RData', sep = '')
save(myout, file = fname)
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_10.RData")
source('plotting.R')
source('plotting.R')
source('plotting.R')
rm(list=ls(all=TRUE))
source('plotting.R')
source('plotting.R')
source('plotting.R')
length(rmserror)
rmserror = rmserror[-(1:burnin)]
plot(rmserror, type = "l")
rmserror = rmserror[-(1:burnin)]
plot(rmserror, type = "l")
abline(h = mean(rmserror), col = "red")
mean(rmserror)
library('coda')
chain = mcmc(thetamat[-(1:burnin), :])
chain = mcmc(thetamat[-(1:burnin)])
summary(chain)
chain = mcmc(thetamat[-(1:burnin), 2:3])
summary(chain)
plot(chain)
source('plotting.R')
library('coda')
chain = mcmc(thetamat[-(1:100), 2:3])
summary(chain)
rmserror = rmserror[-(1:100)]
plot(rmserror)
plot(rmserror, type = "l")
abline(h = mean(rmserror), col = "red")
mean(rmserror)
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_10.RData")
plot(thetamat[-(1:100), 2])
plot(thetamat[-(1:100), 2], type = "l")
plot(thetamat[-(1:100), 3], type = "l")
source('plotting.R')
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_10.RData")
hist(thetamat[-(1:burnin),3], nclass = 30, main = TeX("Posterior of $\\theta_3$"), xlab = TeX("$\\theta_3$ values"), xlim = c(actualtheta[3] - 0.05, actualtheta[3] + 0.05))
abline(v = mean(thetamat[-(1:burnin),3]), col = "green")
abline(v = actualtheta[3], col = "red")
lines(density(thetamat[-(1:burnin),3]), col = "blue")
plot(thetamat[-(1:burnin),3], type = "l", xlab = "Iterations", ylab = TeX("$\\theta_3$ values"), main = TeX("Trace plot of $\\theta_3$"), ylim = c(actualtheta[3] - 0.05, actualtheta[3] + 0.05))
abline(h = actualtheta[3], col = "red")
plot(thetamat[-(1:burnin),3], type = "l")
load("/run/user/1000/gvfs/sftp:host=169.236.72.226,user=shagun/data/shagun/linear_cpp/HMCsamples_10.RData")
plot(thetamat[-(1:burnin),3], type = "l")
plot(thetamat[-(1:burnin),3], type = "l")
